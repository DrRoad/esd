# load the predictands: CLARIS precip
load('~/Dropbox/Public/CORDEX-ESDM-data-clumps/claris.Pr.rda')

# retrieve the predictors
# Out-going long-wave radiation
olr <- annual(retrieve('data/ERAINT/ERAINT_olr_mon.nc',lon=c(-120,-30),lat=c(-45,0)),FUN='mean')
attr(olr,'unit') <- "W * m**-2"
eof.olr <- EOF(olr)

# Temperature
t2m <- retrieve('data/ERAINT/ERAINT_t2m_mon.nc',lon=c(-120,-30),lat=c(-45,0))
es <- annual(C.C.eq(t2m),FUN='mean')
eof.es <- EOF(es)

slp <- annual(retrieve('data/ERAINT/ERAINT_slp_mon.nc',lon=c(-120,-30),lat=c(-45,0)),FUN='mean')
eof.slp <- EOF(slp)

# Process the precipitation - predictand:
mu <- annual(Pr,FUN='wetmean')
pca.mu <- PCA(mu)
fw <- annual(Pr,FUN='wetfreq')
pca.fw <- PCA(fw)

z.mu <- DS(pca.mu,list(olr=eof.olr,es=es,slp=slp),m='cordex-esd-exp1')
z.fw <- DS(pca.mu,list(olr=eof.olr,es=es,slp=slp),m='cordex-esd-exp1')
